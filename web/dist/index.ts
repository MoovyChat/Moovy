import{ae as vt,az as ft,af as Le,ag as st,r as mt}from"./index.js";var ke={};const pt=vt(ft);(function(M){var C=Le&&Le.__assign||function(){return C=Object.assign||function(t){for(var l,a=1,u=arguments.length;a<u;a++){l=arguments[a];for(var A in l)Object.prototype.hasOwnProperty.call(l,A)&&(t[A]=l[A])}return t},C.apply(this,arguments)};Object.defineProperty(M,"__esModule",{value:!0}),M.ViewportList=void 0;var je=pt,n=mt,Y=typeof window>"u",ae=Y?!1:function(){try{return"ontouchstart"in window||navigator.maxTouchPoints}catch{return!1}}(),ce=Y?!1:function(){try{return window.CSS.supports("overflow-anchor: auto")}catch{return!1}}(),Pe=ae&&!ce,Fe={top:"top",bottom:"bottom",clientHeight:"clientHeight",scrollHeight:"scrollHeight",scrollTop:"scrollTop",overflowY:"overflowY",height:"height",minHeight:"minHeight",maxHeight:"maxHeight",marginTop:"marginTop"},De={top:"left",bottom:"right",scrollHeight:"scrollWidth",clientHeight:"clientWidth",scrollTop:"scrollLeft",overflowY:"overflowX",minHeight:"minWidth",height:"width",maxHeight:"maxWidth",marginTop:"marginLeft"},ue=function(t,l,a){var u;return a===void 0&&(a=0),u={padding:0,margin:0,border:"none",visibility:"hidden",overflowAnchor:"none"},u[t.minHeight]=l,u[t.height]=l,u[t.maxHeight]=l,u[t.marginTop]=a,u},R=function(t,l,a){return a===void 0&&(a=1/0),Math.max(Math.min(l,a),t)},G=Y?n.useEffect:n.useLayoutEffect,Ve=function(t){var l=(0,n.useRef)(t);G(function(){l.current=t},[t]),G(function(){var a,u=function(){a=requestAnimationFrame(u),l.current()};return u(),function(){return cancelAnimationFrame(a)}},[])},E=function(t,l,a){return Math.ceil(Math.abs(t-l)/a)},We=function(t,l){var a=t.viewportRef,u=a===void 0?{current:Y?null:document.documentElement}:a,A=t.items,J=A===void 0?[]:A,le=t.itemMinSize,Ye=le===void 0?0:le,ve=t.margin,ze=ve===void 0?-1:ve,fe=t.overscan,Xe=fe===void 0?1:fe,se=t.axis,qe=se===void 0?"y":se,me=t.initialIndex,z=me===void 0?-1:me,pe=t.initialAlignToTop,Ue=pe===void 0?!0:pe,de=t.initialOffset,Ne=de===void 0?0:de,$e=t.children,ge=t.onViewportIndexesChange,he=t.overflowAnchor,Ge=he===void 0?"auto":he,be=t.withCache,Je=be===void 0?!0:be,Re=t.scrollThreshold,Se=Re===void 0?0:Re,Te=t.spacerElement,we=Te===void 0?"div":Te,xe=t.spacerStyle,X=xe===void 0?{}:xe,e=qe==="y"?Fe:De,H=J.length-1,He=(0,n.useState)(function(){return[R(0,Ye),R(-1,ze)]}),_e=He[0],S=_e[0],q=_e[1],Ke=He[1],L=R(0,S+q),ye=R(0,Math.ceil(Xe*L)),Ce=(0,n.useState)([z,z]),U=Ce[0],Ee=Ce[1],o=U[0]=R(0,U[0],H),d=U[1]=R(o,U[1],H),B=(0,n.useRef)(null),K=(0,n.useRef)(null),Q=(0,n.useRef)([]),_=(0,n.useRef)(z>=0?{index:z,alignToTop:Ue,offset:Ne}:null),T=(0,n.useRef)(0),N=(0,n.useRef)([-1,-1]),$=(0,n.useRef)(null),Z=(0,n.useRef)(-1),k=(0,n.useRef)(null),Qe=(0,n.useMemo)(function(){return C(C({},X),ue(e,Q.current.slice(0,o).reduce(function(v,f){return v+(f-S)},o*L),T.current))},[e,o,L,S,X]),Ze=(0,n.useMemo)(function(){return C(C({},X),ue(e,Q.current.slice(d+1,H+1).reduce(function(v,f){return v+(f-S)},L*(H-d))))},[e,d,H,L,S,X]),j=(0,n.useRef)(null);Ve(function(){var v,f,i=u.current,h=B.current,m=K.current;if(!(!i||!h||!m)){var g=h.nextSibling,b=m.previousSibling,P=g===m?m:g.nextSibling,et=b===h?h:b.previousSibling,Ae=i.getBoundingClientRect(),w=h.getBoundingClientRect(),y=m.getBoundingClientRect(),O=(v={},v[e.top]=i===document.documentElement?0:Ae[e.top],v[e.bottom]=i===document.documentElement?document.documentElement.clientHeight:Ae[e.bottom],v),s=(f={},f[e.top]=O[e.top]-ye,f[e.bottom]=O[e.bottom]+ye,f);if(T.current<0&&w[e.top]-T.current>=s[e.top]||T.current>0&&w[e.top]>=s[e.top]||T.current&&_.current){h.style[e.marginTop]="0px",i.style[e.overflowY]="hidden",i[e.scrollTop]+=-T.current,i.style[e.overflowY]="",T.current=0;return}if(S===0||q===-1){if(g===m)return;var Be=S===0?g[e.clientHeight]:S,tt=q===-1?y[e.top]-w[e.bottom]-Be:q;Ke([Be,tt]);return}var I=Math.ceil((y[e.top]-w[e.bottom])/(d+1-o));if(!k.current){if(_.current){var F=R(0,_.current.index,H);if(F<o||F>d){Ee([F,F]);return}for(var c=o,D=g,rt=function(){if(c===F){var lt=_.current.alignToTop,Oe=_.current.offset;_.current=null;var Ie=function(){var Me=D.getBoundingClientRect();lt?i[e.scrollTop]+=Me[e.top]-O[e.top]+Oe:i[e.scrollTop]+=Me[e.bottom]-O[e.top]-i[e.clientHeight]+Oe,k.current=null};return Pe?k.current=setTimeout(Ie,30):Ie(),"break"}c++,D=D.nextSibling};D&&D!==m;){var nt=rt();if(nt==="break")break}return}if(j.current===null)j.current=i.scrollTop;else if(j.current!==i.scrollTop){var ot=Math.abs(i.scrollTop-j.current);if(j.current=i.scrollTop,Se>0&&ot>Se)return}var V=w[e.bottom]>s[e.bottom],W=y[e.top]<s[e.top],it=!V&&!W&&w[e.bottom]>s[e.top],at=!V&&!W&&y[e.top]<s[e.bottom],ct=!V&&!W&&et.getBoundingClientRect()[e.bottom]>s[e.bottom],ut=!V&&!W&&P.getBoundingClientRect()[e.top]<s[e.top],p=o,x=d;if(V&&(p-=E(w[e.bottom],s[e.top],I),x-=E(y[e.top],s[e.bottom],I)),W&&(x+=E(y[e.top],s[e.bottom],I),p+=E(w[e.bottom],s[e.top],I)),it&&(p-=E(w[e.bottom],s[e.top],I)),at&&(x+=E(y[e.top],s[e.bottom],I)),ct)for(var c=d,r=b;r&&r!==h;){if(r.getBoundingClientRect()[e.bottom]<=s[e.bottom]){x=c+1;break}c--,r=r.previousSibling}if(ut)for(var c=o,r=g;r&&r!==m;){if(r.getBoundingClientRect()[e.top]>=s[e.top]){p=c-1;break}c++,r=r.nextSibling}if(ge){for(var c=o,r=g,re=o;r&&r!==m;){if(r.getBoundingClientRect()[e.bottom]>O[e.top]){re=c;break}c++,r=r.nextSibling}c=d,r=b;for(var ne=d;r&&r!==h;){if(r.getBoundingClientRect()[e.top]<O[e.bottom]){ne=c;break}c--,r=r.previousSibling}(re!==N.current[0]||ne!==N.current[1])&&(N.current=[re,ne],ge(N.current))}if(p=R(0,p,H),x=R(p,x,H),!(p===o&&x===d)){if(p!==o){var oe=null,ie=-1;if(o>=p&&o<=x)oe=g,ie=o;else if(p>=o&&p<=d)for(var c=o,r=g;r&&r!==m;){if(c===p){oe=r,ie=c;break}Je&&r[e.clientHeight]!==S&&(Q.current[c]=r[e.clientHeight]),c++,r=r.nextSibling}$.current=oe,Z.current=ie}Ee([p,x])}}}});var ee,te;return $.current&&u.current&&B.current&&(ee=u.current[e.scrollTop],te=$.current.getBoundingClientRect()[e.top]-B.current.getBoundingClientRect()[e.top]),G(function(){$.current=null;var v=Z.current;Z.current=-1;var f=u.current,i=B.current,h=K.current;if(!(ce&&Ge!=="none"||v===-1||!f||!i||!h||ee===void 0||te===void 0||ee!==u.current[e.scrollTop])){for(var m=null,g=o,b=i.nextSibling;b&&b!==h;){if(g===v){m=b;break}g++,b=b.nextSibling}if(m){var P=m.getBoundingClientRect()[e.top]-i.getBoundingClientRect()[e.top]-te;if(P){if(ae){T.current-=P,B.current.style[e.marginTop]=T.current+"px";return}u.current[e.scrollTop]+=P}}}},[o]),(0,n.useEffect)(function(){return function(){k.current&&clearTimeout(k.current)}},[]),(0,n.useImperativeHandle)(l,function(){return{scrollToIndex:function(v,f,i){v===void 0&&(v=-1),f===void 0&&(f=!0),i===void 0&&(i=0),_.current={index:v,alignToTop:f,offset:i}}}},[]),(0,je.jsxs)(n.Fragment,{children:[(0,n.createElement)(we,{ref:B,style:Qe}),J.slice(o,d+1).map(function(v,f){return $e(v,o+f,J)}),(0,n.createElement)(we,{ref:K,style:Ze})]},void 0)};M.ViewportList=(0,n.forwardRef)(We),M.default=M.ViewportList})(ke);const gt=st(ke);export{gt as V};
